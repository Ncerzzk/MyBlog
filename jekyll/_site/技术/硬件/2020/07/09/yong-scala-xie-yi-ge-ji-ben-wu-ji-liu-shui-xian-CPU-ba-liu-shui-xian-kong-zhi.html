<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.6.1 -->
<title>用scala写一个基本五级流水线CPU(八)流水线控制 | Huangzzk’s Blog</title>
<meta name="generator" content="Jekyll v4.0.0" />
<meta property="og:title" content="用scala写一个基本五级流水线CPU(八)流水线控制" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="总有一种问题越写越多的感觉呢。" />
<meta property="og:description" content="总有一种问题越写越多的感觉呢。" />
<link rel="canonical" href="https://ncerzzk.github.io/%E6%8A%80%E6%9C%AF/%E7%A1%AC%E4%BB%B6/2020/07/09/yong-scala-xie-yi-ge-ji-ben-wu-ji-liu-shui-xian-CPU-ba-liu-shui-xian-kong-zhi.html" />
<meta property="og:url" content="https://ncerzzk.github.io/%E6%8A%80%E6%9C%AF/%E7%A1%AC%E4%BB%B6/2020/07/09/yong-scala-xie-yi-ge-ji-ben-wu-ji-liu-shui-xian-CPU-ba-liu-shui-xian-kong-zhi.html" />
<meta property="og:site_name" content="Huangzzk’s Blog" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2020-07-09T18:29:45+08:00" />
<script type="application/ld+json">
{"@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://ncerzzk.github.io/%E6%8A%80%E6%9C%AF/%E7%A1%AC%E4%BB%B6/2020/07/09/yong-scala-xie-yi-ge-ji-ben-wu-ji-liu-shui-xian-CPU-ba-liu-shui-xian-kong-zhi.html"},"url":"https://ncerzzk.github.io/%E6%8A%80%E6%9C%AF/%E7%A1%AC%E4%BB%B6/2020/07/09/yong-scala-xie-yi-ge-ji-ben-wu-ji-liu-shui-xian-CPU-ba-liu-shui-xian-kong-zhi.html","headline":"用scala写一个基本五级流水线CPU(八)流水线控制","dateModified":"2020-07-09T18:29:45+08:00","datePublished":"2020-07-09T18:29:45+08:00","description":"总有一种问题越写越多的感觉呢。","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/main.css"><link type="application/atom+xml" rel="alternate" href="https://ncerzzk.github.io/feed.xml" title="Huangzzk's Blog" /><script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?9a0d201458675d03a87e467407e4889b";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>


</head>
<body><header class="site-header" role="banner">

  <div class="wrapper"><a class="site-title" rel="author" href="/">Huangzzk&#39;s Blog</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/aboutme/">关于</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <style type="text/css">
.css_btn_class {
	font-size:16px;
	font-family:Arial;
	font-weight:normal;
	-moz-border-radius:8px;
	-webkit-border-radius:8px;
	border-radius:8px;
	border:1px solid #dcdcdc;
	padding:9px 18px;
	text-decoration:none;
	background:-webkit-gradient( linear, left top, left bottom, color-stop(5%, #ffffff), color-stop(100%, #f6f6f6) );
	background:-moz-linear-gradient( center top, #ffffff 5%, #f6f6f6 100% );
	background:-ms-linear-gradient( top, #ffffff 5%, #f6f6f6 100% );
	filter:progid:DXImageTransform.Microsoft.gradient(startColorstr='#ffffff', endColorstr='#f6f6f6');
	background-color:#ffffff;
	color:#666666;
	display:inline-block;
	text-shadow:1px 1px 0px #ffffff;
 	-webkit-box-shadow:inset 1px 1px 0px 0px #ffffff;
 	-moz-box-shadow:inset 1px 1px 0px 0px #ffffff;
 	box-shadow:inset 1px 1px 0px 0px #ffffff;
}.css_btn_class:hover {
	background:-webkit-gradient( linear, left top, left bottom, color-stop(5%, #f6f6f6), color-stop(100%, #ffffff) );
	background:-moz-linear-gradient( center top, #f6f6f6 5%, #ffffff 100% );
	background:-ms-linear-gradient( top, #f6f6f6 5%, #ffffff 100% );
	filter:progid:DXImageTransform.Microsoft.gradient(startColorstr='#f6f6f6', endColorstr='#ffffff');
	background-color:#f6f6f6;
}.css_btn_class:active {
	position:relative;
	top:1px;
}

.comment_username{
font-size:14px;
margin-left:5px;
}
.comment_time{
font-size:14px;	
	float:right;
	margin-right:5px;
}
.comment{
	list-style:none;
}
.comment_username{
	color: #24292e;
	text-decoration: none;
	}
	.comment_user_img{
	float:left;
}
.comment_box{
	margin-left:40px;
    color: #24292e;
    background-color: #fff;
    border: 1px solid #d1d5da;
    border-radius: 3px;
}
.comment_content{
margin:10px 10px 10px 10px;
}

#comment{
	margin-top:30px;
}

.comment{
	margin-top:30px;
}

/* CSS按钮生成器 */
</style>

<article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">用scala写一个基本五级流水线CPU(八)流水线控制</h1>
    <p class="post-meta">
      <time class="dt-published" datetime="2020-07-09T18:29:45+08:00" itemprop="datePublished">Jul 9, 2020
      </time></p>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <p>总有一种问题越写越多的感觉呢。</p>

<h2 id="遗留的冒险问题">遗留的冒险问题</h2>

<p>之前遗留的冒险问题还有：</p>

<ul>
  <li>
    <p>load的数据相关</p>

    <div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="n">load</span> <span class="err">$</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">(</span><span class="err">$</span><span class="mi">0</span><span class="p">)</span>
  <span class="n">addiu</span> <span class="err">$</span><span class="mi">2</span><span class="p">,</span><span class="err">$</span><span class="mi">1</span><span class="p">,</span><span class="mi">100</span>
</code></pre></div>    </div>

    <p>类似于这样的问题，addiu需要在执行级的时候确定操作数（来自于ID或者来自于旁路），但是此时$1的值还没准备好，因为load的指令要在mem的后期才能取得值。</p>

    <p>简单来说，以目前实现(改版后）的流水线而言，如果两个数据相关的指令相邻，那么上一条指令必须在EX结束前就得到计算结果，下一条指令才可以直接通过旁路获取到。</p>

    <ul>
      <li>解决方式：在第二条指令的译码阶段增加相关性判断，如果与上一条一句有相关性，那么就插入一条空指令，并将前级的流水线暂停1个周期，这样就可以将相邻的指令，变成了1 gap 指令，就可以正常取得值了</li>
    </ul>
  </li>
  <li>
    <p>分支指令实现问题</p>
    <ul>
      <li>之前分支指令如beq等，为了不在流水线中加入空泡（nops），将分支的跳转提前到了ID中来实现（参考《自己动手写CPU》），但是由于旁路的修改的，在ID阶段已经不能获取到旁路了，也就无法进行分支判断。
        <ul>
          <li>解决方法：修改beq等指令的实现：将其跳转判断放到EX中，同时一旦预测失败，将IF/ID中取得指令清除（变成空泡）。</li>
        </ul>
      </li>
    </ul>
  </li>
</ul>

<h2 id="实现">实现</h2>

<p>从上面的分析可以知道，我们需要一个流水线控制器来控制流水线（暂存级）的运行、暂停、或者清除。流水线控制器还在什么地方用到呢，比如除法这种多周期指令（目前还没实现）执行的时候，需要将前级暂停下来，等他表演完。还比如用在缓存未命中的时候（目前还没使用缓存，或者说目前的缓存百分百命中，一个周期就可以读出数据），需要通过总线控制器（目前还没用到总线）向内存读取，此时就要将流水线暂停起来，</p>

<p>先定义一组流水线的运行状态枚举:(有三种状态，分别为清除、暂停、和正常启用)</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">object</span> <span class="nc">StageStateEnum</span> <span class="k">extends</span> <span class="nc">SpinalEnum</span><span class="o">(</span><span class="n">binaryOneHot</span><span class="o">){</span>
  <span class="k">val</span> <span class="nv">FLUSH</span><span class="o">,</span><span class="nc">STALL</span><span class="o">,</span><span class="nc">ENABLE</span> <span class="k">=</span> <span class="nf">newElement</span><span class="o">()</span>
<span class="o">}</span>
</code></pre></div></div>

<p>再定义一组流水线控制请求的枚举： （这些定义不会马上全部用到，但先定义着，可能以后也会再修改）</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">object</span> <span class="nc">StageCTRLReqEnum</span> <span class="k">extends</span> <span class="nc">SpinalEnum</span><span class="o">{</span>
  <span class="k">val</span> <span class="nv">NORMAL</span> <span class="k">=</span> <span class="nf">newElement</span><span class="o">()</span>
  <span class="k">val</span> <span class="nv">IFSTALL</span><span class="o">,</span><span class="nc">IDSTALL</span><span class="o">,</span><span class="nc">EXSTALL</span><span class="o">,</span><span class="nc">MEMSTALL</span><span class="k">=</span><span class="nf">newElement</span><span class="o">()</span>
  <span class="k">val</span> <span class="nv">IFFLUSH</span><span class="o">,</span><span class="nc">IDFLUSH</span><span class="o">,</span><span class="nc">EXFLUSH</span><span class="k">=</span><span class="nf">newElement</span><span class="o">()</span>
<span class="o">}</span>
</code></pre></div></div>

<p>再定义两种端口,分别是控制请求发起的端口（放在ID模块、EX模块中）、暂存级的控制端口（放在流水线的暂存级中以及PC寄存器，如if2id这些）</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">StageCTRLReqBundle</span> <span class="k">extends</span> <span class="nc">Bundle</span> <span class="k">with</span> <span class="nc">IMasterSlave</span><span class="o">{</span>
  <span class="k">val</span> <span class="nv">req</span> <span class="k">=</span> <span class="nc">StageCTRLReqEnum</span><span class="o">()</span>

  <span class="k">override</span> <span class="k">def</span> <span class="nf">asMaster</span><span class="o">()</span><span class="k">:</span> <span class="kt">Unit</span> <span class="o">=</span> <span class="o">{</span>
    <span class="nf">out</span> <span class="o">(</span><span class="n">req</span><span class="o">)</span>
  <span class="o">}</span>
<span class="o">}</span>

<span class="k">class</span> <span class="nc">StageCTRLBundle</span> <span class="k">extends</span> <span class="nc">Bundle</span> <span class="k">with</span> <span class="nc">IMasterSlave</span><span class="o">{</span>
  <span class="k">val</span> <span class="nv">stateOut</span> <span class="k">=</span> <span class="nc">StageStateEnum</span><span class="o">()</span>

  <span class="k">override</span> <span class="k">def</span> <span class="nf">asMaster</span><span class="o">()</span><span class="k">:</span> <span class="kt">Unit</span> <span class="o">=</span> <span class="o">{</span>
    <span class="nf">out</span><span class="o">(</span><span class="n">stateOut</span><span class="o">)</span>
  <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<p>流水线控制器的实现：</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="k">class</span> <span class="nc">StageCTRL</span> <span class="k">extends</span> <span class="nc">Component</span><span class="o">{</span>
  <span class="k">val</span> <span class="nv">slaves</span> <span class="k">=</span> <span class="nc">Vec</span><span class="o">(</span><span class="nf">master</span><span class="o">(</span><span class="k">new</span> <span class="nc">StageCTRLBundle</span><span class="o">()),</span><span class="mi">4</span><span class="o">)</span>
  <span class="k">val</span> <span class="nv">reqFromID</span><span class="k">=</span> <span class="nf">slave</span><span class="o">(</span><span class="k">new</span> <span class="nc">StageCTRLReqBundle</span><span class="o">())</span>
  <span class="k">val</span> <span class="nv">reqFromEX</span><span class="k">=</span> <span class="nf">slave</span><span class="o">(</span><span class="k">new</span> <span class="nc">StageCTRLReqBundle</span><span class="o">())</span>

  <span class="k">def</span> <span class="nf">&lt;&gt;</span><span class="o">(</span><span class="n">a</span><span class="k">:</span><span class="kt">List</span><span class="o">[</span><span class="kt">StageCTRLBundle</span><span class="o">])</span><span class="k">:</span><span class="kt">Unit</span><span class="o">={</span>
    <span class="c1">// 顺序应该是 PC，IF2ID,ID2EX,EX2MEM</span>
    <span class="c1">// 不能放错误顺序</span>
    <span class="nf">for</span><span class="o">(</span><span class="n">i</span> <span class="k">&lt;-</span> <span class="nv">a</span><span class="o">.</span><span class="py">indices</span><span class="o">){</span>
      <span class="nf">a</span><span class="o">(</span><span class="n">i</span><span class="o">)</span> <span class="o">&lt;&gt;</span> <span class="nf">slaves</span><span class="o">(</span><span class="n">i</span><span class="o">)</span>
    <span class="o">}</span>
  <span class="o">}</span>

  <span class="k">def</span> <span class="nf">&lt;&gt;</span><span class="o">(</span><span class="n">ex</span><span class="k">:</span><span class="kt">EX</span><span class="o">)</span><span class="k">=</span><span class="n">reqFromEX</span> <span class="o">&lt;&gt;</span> <span class="nv">ex</span><span class="o">.</span><span class="py">reqCTRL</span>
  <span class="k">def</span> <span class="nf">&lt;&gt;</span><span class="o">(</span><span class="n">id</span><span class="k">:</span><span class="kt">ID</span><span class="o">)</span><span class="k">=</span><span class="n">reqFromID</span> <span class="o">&lt;&gt;</span> <span class="nv">id</span><span class="o">.</span><span class="py">reqCTRL</span>

  <span class="nv">slaves</span><span class="o">.</span><span class="py">foreach</span><span class="o">(</span><span class="n">s</span><span class="k">=&gt;</span><span class="nv">s</span><span class="o">.</span><span class="py">stateOut</span><span class="o">:=</span><span class="nv">StageStateEnum</span><span class="o">.</span><span class="py">ENABLE</span><span class="o">)</span>
  <span class="k">val</span> <span class="nv">req</span> <span class="k">=</span> <span class="o">(</span><span class="nv">reqFromEX</span><span class="o">.</span><span class="py">req</span> <span class="o">===</span> <span class="nv">StageCTRLReqEnum</span><span class="o">.</span><span class="py">NORMAL</span><span class="o">)</span> <span class="o">?</span><span class="nv">reqFromID</span><span class="o">.</span><span class="py">req</span> <span class="o">|</span> <span class="nv">reqFromEX</span><span class="o">.</span><span class="py">req</span> 
  <span class="nf">when</span><span class="o">(</span><span class="n">req</span> <span class="o">===</span> <span class="nv">StageCTRLReqEnum</span><span class="o">.</span><span class="py">IFFLUSH</span><span class="o">){</span>
    <span class="nf">slaves</span><span class="o">(</span><span class="mi">1</span><span class="o">).</span><span class="py">stateOut</span> <span class="o">:=</span> <span class="nv">StageStateEnum</span><span class="o">.</span><span class="py">FLUSH</span>
  <span class="o">}</span><span class="nf">elsewhen</span><span class="o">(</span><span class="n">req</span> <span class="o">===</span> <span class="nv">StageCTRLReqEnum</span><span class="o">.</span><span class="py">IDSTALL</span><span class="o">){</span>
    <span class="nf">slaves</span><span class="o">(</span><span class="mi">0</span><span class="o">).</span><span class="py">stateOut</span> <span class="o">:=</span> <span class="nv">StageStateEnum</span><span class="o">.</span><span class="py">STALL</span>
    <span class="nf">slaves</span><span class="o">(</span><span class="mi">1</span><span class="o">).</span><span class="py">stateOut</span> <span class="o">:=</span> <span class="nv">StageStateEnum</span><span class="o">.</span><span class="py">STALL</span>
    <span class="nf">slaves</span><span class="o">(</span><span class="mi">2</span><span class="o">).</span><span class="py">stateOut</span> <span class="o">:=</span> <span class="nv">StageStateEnum</span><span class="o">.</span><span class="py">FLUSH</span>
  <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<p>目前还仅实现了几种情况，等需要的时候再继续加吧。在PC、Stage（各个流水线暂存级）中增加流水线控制接口，在ID、EX中增加流水线控制请求接口就省略了，还挺累的。</p>

<h3 id="解决load的相关性问题">解决LOAD的相关性问题</h3>

<p>在ID中检测本条指令与上条指令的一些信息来判断是否相关。上条指令的信息来自于EX模块。一旦发现是LOAD，且有相关性，就暂停到ID的流水线（PC、IF2ID暂停，ID2EX清空（注意这里必须是清空，如果只是暂停，就会导致上一条LOAD指令永远执行））</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="nf">when</span><span class="o">(</span><span class="nv">lastInstInfo</span><span class="o">.</span><span class="py">op</span><span class="o">===</span><span class="nv">OpEnum</span><span class="o">.</span><span class="py">LOAD</span><span class="o">.</span><span class="py">asBits</span><span class="o">.</span><span class="py">resized</span><span class="o">){</span>
    <span class="nf">when</span><span class="o">(</span><span class="nv">lastInstInfo</span><span class="o">.</span><span class="py">writeAddr</span> <span class="o">===</span> <span class="nv">regHeap</span><span class="o">.</span><span class="py">readAddrs</span><span class="o">(</span><span class="mi">0</span><span class="o">)</span> <span class="o">||</span> <span class="nv">lastInstInfo</span><span class="o">.</span><span class="py">writeAddr</span><span class="o">===</span><span class="nv">regHeap</span><span class="o">.</span><span class="py">readAddrs</span><span class="o">(</span><span class="mi">1</span><span class="o">)){</span>
      <span class="nv">reqCTRL</span><span class="o">.</span><span class="py">req</span> <span class="o">:=</span> <span class="nv">StageCTRLReqEnum</span><span class="o">.</span><span class="py">IDSTALL</span>
    <span class="o">}</span>
  <span class="o">}</span>
</code></pre></div></div>

<h3 id="将分支语句挪到ex级">将分支语句挪到EX级</h3>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nf">if</span><span class="o">(</span><span class="nv">i</span><span class="o">.</span><span class="py">_1</span> <span class="o">==</span> <span class="nv">OpEnum</span><span class="o">.</span><span class="py">BRANCH</span><span class="o">)</span> <span class="o">{</span>
              <span class="nf">when</span><span class="o">(</span><span class="nf">func</span><span class="o">(</span><span class="n">oprnd1</span><span class="o">,</span><span class="n">oprnd2</span><span class="o">).</span><span class="py">asInstanceOf</span><span class="o">[</span><span class="kt">Bool</span><span class="o">]){</span>
                <span class="k">val</span> <span class="nv">target</span><span class="k">=</span> <span class="o">(</span><span class="nv">inst</span><span class="o">.</span><span class="py">immI</span><span class="o">.</span><span class="py">asSInt</span><span class="o">.</span><span class="py">resize</span><span class="o">(</span><span class="nv">GlobalConfig</span><span class="o">.</span><span class="py">dataBitsWidth</span><span class="o">)+</span><span class="nv">lastStage</span><span class="o">.</span><span class="py">pc</span><span class="o">.</span><span class="py">asSInt</span><span class="o">+</span><span class="mi">1</span><span class="o">).</span><span class="py">asBits</span>
                <span class="nv">pcPort</span><span class="o">.</span><span class="py">JMP</span><span class="o">(</span><span class="n">target</span><span class="o">)</span>
                <span class="nv">reqCTRL</span><span class="o">.</span><span class="py">req</span> <span class="o">:=</span> <span class="nv">StageCTRLReqEnum</span><span class="o">.</span><span class="py">IFFLUSH</span>
<span class="o">}</span>
</code></pre></div></div>

<h2 id="测试">测试</h2>

<p>修改完后对之前提到的两个问题挨个进行测试。</p>

<h3 id="load数据相关问题">load数据相关问题</h3>
<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code>	<span class="n">LBU</span> <span class="err">$</span><span class="mi">1</span><span class="p">,</span><span class="mo">01</span><span class="p">(</span><span class="err">$</span><span class="mi">0</span><span class="p">)</span>
	<span class="n">addiu</span> <span class="err">$</span><span class="mi">2</span><span class="p">,</span><span class="err">$</span><span class="mi">1</span><span class="p">,</span><span class="mi">100</span>
</code></pre></div></div>

<p><img src="https://raw.githubusercontent.com/Ncerzzk/MyBlog/master/img/loadproblem.jpg" alt="此处输入图片的描述" /></p>

<p>可以看到在第一条指令后插入了NOPS。</p>

<p>最后的结果是355(十进制)（内存默认填充了0xFFFF）</p>

<h3 id="beq在id无法获取操作数问题">beq在ID无法获取操作数问题</h3>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="n">addiu</span> <span class="err">$</span><span class="mi">1</span><span class="p">,</span> <span class="err">$</span><span class="mi">0</span><span class="p">,</span> <span class="mh">0x1100</span>
    <span class="n">b</span> <span class="mi">2</span>
    <span class="n">addiu</span> <span class="err">$</span><span class="mi">2</span><span class="p">,</span> <span class="err">$</span><span class="mi">0</span><span class="p">,</span> <span class="mh">0x0111</span>
    <span class="n">and</span>   <span class="err">$</span><span class="mi">3</span><span class="p">,</span> <span class="err">$</span><span class="mi">1</span> <span class="p">,</span><span class="err">$</span><span class="mi">2</span>
    <span class="n">or</span>    <span class="err">$</span><span class="mi">4</span><span class="p">,</span> <span class="err">$</span><span class="mi">1</span><span class="p">,</span> <span class="err">$</span><span class="mi">2</span>
</code></pre></div></div>

<p><img src="https://raw.githubusercontent.com/Ncerzzk/MyBlog/master/img/beq.jpg" alt="此处输入图片的描述" /></p>

<p>可以看到结果与以前一样，and指令被跳过，所以$3没有值。可以观察跳转指令的延迟槽之后有个空泡（Nops）。</p>

  </div><!--
	<a href="https://github.com/Ncerzzk/Myblog/issues/129" class="css_btn_class">添加留言</a>
	-->
	
<div id="comment">
<li class="comment">
	
	<img class="comment_user_img"  height="40" width="40" src="https://avatars2.githubusercontent.com/u/9284611?v=4"></img>
	<div class="comment_box">
	<a class="comment_username" href="#">Username</a>
	<span class="comment_time">Comment at 2019.5.13</span>
	<div class="comment_content">Here is the Content</div>
	</div>
</li>
</div>
		
	
  <a class="u-url" href="/%E6%8A%80%E6%9C%AF/%E7%A1%AC%E4%BB%B6/2020/07/09/yong-scala-xie-yi-ge-ji-ben-wu-ji-liu-shui-xian-CPU-ba-liu-shui-xian-kong-zhi.html" hidden></a>
</article>

<script src="https://cdn.staticfile.org/jquery/2.0.0/jquery.min.js">
</script>

<script>

$(document).ready(function(){
  $("button").click(function(){
    $(this).hide();
  });
});
var h=$("#comment").html();
var user="Ncerzzk";
var repo="Myblog";
var issueid="129";
$("#comment").html("");
$.getJSON("https://api.github.com/repos/"+user+"/"+repo+"/issues/"+issueid+"/comments", function(json){
  for(i in json){
	  $("#comment").append(h);
	  $(".comment_username:last").text(json[i].user.login);
	  $(".comment_username:last").attr("href",json[i].user.html_url);
	  $(".comment_content:last").text(json[i].body);
	  $(".comment_time:last").text(json[i].created_at);
	  $(".comment_user_img:last").attr("src",json[i].user.avatar_url);
  }
});
</script>


      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <h2 class="footer-heading">Huangzzk&#39;s Blog</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name">Huangzzk&#39;s Blog</li><li><a class="u-email" href="mailto:e.255mail#gmail.com">e.255mail#gmail.com</a></li></ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list"><li><a href="https://github.com/Ncerzzk"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#github"></use></svg> <span class="username">Ncerzzk</span></a></li></ul>
</div>

      <div class="footer-col footer-col-3">
        <p>Hello,world!</p>
      </div>
    </div>
	<div>
		<a href="http://beian.miit.gov.cn/">闽ICP备20002143号</a>
	</div>
  </div>

</footer>
</body>
<script>
  window.onload=function (){
    var content = document.getElementsByTagName("html")[0].innerHTML;
    content = content.replace(/博客|Blog|blog/g,"");
    console.log(content);

    document.getElementsByTagName("html")[0].innerHTML = content; 
  }
</script>
</html>
