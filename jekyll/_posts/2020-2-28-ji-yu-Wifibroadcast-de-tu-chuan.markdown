---
layout: post
title: 基于Wifibroadcast的图传
date: 2020-02-28 14:46:17 +0900
categories: 技术 兴趣
issue_id: 82
---

去年就关注的项目，一直没时间仔细看一下它的原理，这两天总算有空看了一下。

这个图传的主要优点有：

- 便宜，使用树莓派，最低支持树莓派Zero W，实际上也支持国产的很多嵌入式板子，只要能跑linux
- 是个数字图传，但是能达到模拟图传的效果
  - 虽然是基于wifi，但不是基于连接的，也就是不会有wifi断了之后，得等好几秒重连才会又有画面
  - 清晰度比一般的模拟图传高
  - 可以录像，无需专门的采集卡。一般的模拟图传是需要采集卡的
  - 可以使用多个接收机，来实现soft diversity

去年年底作者在某个网站发表了个关于这个的演讲，可以参考：
https://media.ccc.de/v/36c3-10630-wifibroadcast

根据作者自己说，发射端是运行在Inject模式下，接收端是运行在monitor模式下，只有一些网卡支持这两种模式。我对wifi也不熟，去搜了一下，只招到了wifi的monitor模式，
就是可以接收所有的封包，似乎可以用来做wifi的监听。

至于inject模式，搜索无果。但是根据他调用的pcap_inject函数，找到了手册：
http://www.tcpdump.org/manpages/pcap_inject.3pcap.html

手册说即使调用了这个函数，也未必可以发送出去，需要看接口是否支持。这估计就是作者所说的不是所有的网卡都满足了吧。

发送和接收部分比较琐碎，还没仔细看。

项目中还是用了前向纠错（Forward error correct），通信术语，我也不懂，搜了一下，就是发送数据的同时，再发送一些冗余项，如果CRC检测错误，那么可以根据冗余项来得到正确的值，不必再feedback。以前学计网的时候老师似乎有讲过这个，不过当时当故事来听的，早都还给老师了。

但是目前手头上没有树莓派，看了一下日本的价格也挺贵的，不太舍得买。还是之后回国再测试一下吧。

如果这个好用的话，估计可以用在我的飞机上，之前一直嫌模拟图传的效果太差，距离稍微远一点就都是雪花纹，而且也不能录像，只能飞爽。



